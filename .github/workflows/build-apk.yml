name: ğŸ¤– Build Pythonlingo APK (Hybrid)

# main branch á€€á€­á€¯ push á€œá€¯á€•á€ºá€œá€­á€¯á€€á€ºá€á€­á€¯á€„á€ºá€¸ á€á€­á€¯á€·á€™á€Ÿá€¯á€á€º manually run á€œá€­á€¯á€€á€ºá€á€­á€¯á€„á€ºá€¸ á€¡á€œá€¯á€•á€ºá€œá€¯á€•á€ºá€›á€”á€º
on:
  push:
    branches:
      - main
  workflow_dispatch:

jobs: # <- á€¤á€”á€±á€›á€¬á€á€Šá€º YAML structure á€¡á€› á€™á€¾á€”á€ºá€€á€”á€ºá€á€±á€¬ á€¡á€…á€–á€¼á€…á€ºá€•á€«á€á€Šá€ºá‹
  build_hybrid_apk:
    # GitHub á€›á€²á€· Cloud Server (Linux) á€€á€­á€¯ á€¡á€á€¯á€¶á€¸á€•á€¼á€¯á€›á€”á€º á€á€á€ºá€™á€¾á€á€ºá€á€¼á€„á€ºá€¸
    runs-on: ubuntu-latest
    
    steps:
      # Code á€™á€»á€¬á€¸á€€á€­á€¯ Cloud Server á€á€­á€¯á€· clone á€œá€¯á€•á€ºá€á€¼á€„á€ºá€¸
      - name: â¬‡ï¸ Checkout Code
        uses: actions/checkout@v4

      # Node.js á€”á€¾á€„á€ºá€· NPM á€€á€­á€¯ á€‘á€Šá€·á€ºá€á€½á€„á€ºá€¸á€á€¼á€„á€ºá€¸ (Hybrid App Build á€¡á€á€½á€€á€º á€™á€›á€¾á€­á€™á€–á€¼á€…á€º)
      - name: âš™ï¸ Setup Node.js Environment
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          
      # Apache Cordova (Hybrid App Tool) á€€á€­á€¯ install á€œá€¯á€•á€ºá€á€¼á€„á€ºá€¸
      - name: ğŸ“¦ Install Cordova CLI
        run: npm install -g cordova

      # =======================================================
      # ğŸš§ Cordova Project Configuration á€”á€¾á€„á€ºá€· Build
      # =======================================================
      - name: ğŸ—ï¸ Setup Cordova Project Structure
        # Cordova project á www folder á€‘á€²á€á€­á€¯á€· index.html á€€á€­á€¯ á€€á€°á€¸á€‘á€Šá€ºá€·á€›á€”á€º á€œá€­á€¯á€¡á€•á€ºá€á€Šá€º
        run: |
          # Cordova Project á€¡á€á€…á€º á€–á€”á€ºá€á€®á€¸á€á€¼á€„á€ºá€¸
          cordova create app com.tra1993.pythonlingo PythonLingo
          
          # HTML/JS Code á€™á€»á€¬á€¸ á€‘á€Šá€ºá€·á€á€½á€„á€ºá€¸á€á€¼á€„á€ºá€¸
          cp index.html app/www/index.html
          
      - name: ğŸ› ï¸ Add Android Platform and Build APK
        # Project Folder á€‘á€²á€á€­á€¯á€· á€á€„á€ºá€›á€±á€¬á€€á€ºá€•á€¼á€®á€¸ Android Build á€œá€¯á€•á€ºá€›á€”á€º
        run: |
          cd app
          # Android Platform á€€á€­á€¯ á€‘á€Šá€ºá€·á€á€½á€„á€ºá€¸á€›á€”á€º
          cordova platform add android
          # Debug build á€€á€­á€¯ á€–á€”á€ºá€á€®á€¸á€•á€« (Cloud Server á€á€½á€„á€º á€œá€¯á€•á€ºá€†á€±á€¬á€„á€ºá€™á€Šá€º)
          cordova build android --debug 
          
      # =======================================================
      
      # Build á€•á€¼á€®á€¸á€…á€®á€¸á€á€±á€¬ APK file á€€á€­á€¯ Artifact á€¡á€–á€¼á€…á€º á€á€­á€™á€ºá€¸á€†á€Šá€ºá€¸á€á€¼á€„á€ºá€¸
      # debug APK á€á€Šá€º platforms/android/app/build/outputs/apk/debug/ á€á€½á€„á€º á€›á€¾á€­á€á€Šá€º
      - name: â¬†ï¸ Upload APK Artifact
        uses: actions/upload-artifact@v4
        with:
          name: pythonlingo-debug-apk
          path: app/platforms/android/app/build/outputs/apk/debug/*.apk 
          retention-days: 7

      - name: âœ… Workflow Summary
        run: echo "APK Build Workflow Has Completed!"
